(this["webpackJsonpVirtual-Companion"]=this["webpackJsonpVirtual-Companion"]||[]).push([[0],{41:function(t,e,i){t.exports=i.p+"static/media/Bird_simple.d1d4aa0b.glb"},70:function(t,e,i){t.exports=i(88)},75:function(t,e,i){},76:function(t,e,i){},88:function(t,e,i){"use strict";i.r(e);var n=i(5),a=i.n(n),r=i(36),s=i.n(r),o=(i(75),i(76),i(1)),h=i(4),c=i(2),u=i(3),l=i(17),d=i(0),p=i(37),f=i.n(p),m=i(38),v=i.n(m),g=i(39),w=i(40),y=function(t,e,i,n,a){var r=Math.sqrt(t*t+e*e+i*i);t/=r,e/=r,i/=r;var s=Math.cos(n/2),o=Math.sin(n/2);a.set(t*o,e*o,i*o,s)},b=function(){function t(e){Object(o.a)(this,t),this.theta_rad=0,this.amp=e.amp,this.isClockwise=e.dir,this.originPos=e.pos,this.moveFactor=e.move,this.targetPos=new d.Vector3(0,0,0)}return Object(h.a)(t,[{key:"updateTheta",value:function(t){this.theta_rad=this.isClockwise?this.theta_rad+this.moveFactor:this.theta_rad-this.moveFactor,this.theta_rad=this.theta_rad>=t?0:this.theta_rad}},{key:"cartesianX",value:function(t){return this.originPos.x+t*Math.cos(this.theta_rad)}},{key:"cartesianZ",value:function(t){return this.originPos.z+t*Math.sin(this.theta_rad)}},{key:"cartesianY",value:function(t){return this.originPos.y+this.amp*Math.sin(this.theta_rad)}},{key:"getTargetPos",value:function(){return this.targetPos}},{key:"syncPatternObj",value:function(){}}]),t}(),k=function(t){Object(c.a)(i,t);var e=Object(u.a)(i);function i(t){var n;return Object(o.a)(this,i),(n=e.call(this,t)).radX=t.radx,n.radZ=t.radz,n.maxTheta=2*Math.PI,n}return Object(h.a)(i,[{key:"update",value:function(){var t=this.cartesianX(this.radX),e=this.cartesianZ(this.radZ),i=this.cartesianY();this.targetPos.set(t,i,e),this.updateTheta(this.maxTheta)}}]),i}(b),P=function(){function t(){Object(o.a)(this,t),this.position=new d.Vector3(0,2,0),this.velocity=new d.Vector3(.1,.1,.1),this.acceleration=new d.Vector3(0,0,0),this.rotationA=new d.Quaternion,this.rotationB=new d.Quaternion,this.fSteer=new d.Vector3(0,0,0),this.sumVec=new d.Vector3(0,0,0),this.diffVec=new d.Vector3(0,0,0),this.maxForce=.1,this.maxSpeed=.1,this.maxSlowDownSpeed=0,this.slowDownTolerance=.2*.2,this.arriveTolerance=1e-4,this.smoothFactor=.001,this.target=new d.Vector3(0,0,0),this.setupPattern()}return Object(h.a)(t,[{key:"updateAgent",value:function(){this.updatePattern()}},{key:"applyBehavior",value:function(){this.seek(),this.applyForce()}},{key:"updatePosition",value:function(){this.sumVec.addVectors(this.velocity,this.acceleration),this.velocity.clampLength(-9999,this.maxSpeed),this.position.add(this.velocity),this.acceleration.multiplyScalar(0)}},{key:"applyForce",value:function(){this.acceleration.add(this.fSteer)}},{key:"seek",value:function(){this.fSteer.subVectors(this.target,this.position);var t,e,i,n,a,r=this.fSteer.lengthSq();if(this.fSteer.normalize(),r<this.slowDownTolerance&&r>this.arriveTolerance){var s=(t=r,e=this.slowDownTolerance,i=this.arriveTolerance,n=this.maxSpeed,a=this.maxSlowDownSpeed,n+(a-n)*(t-e)/(i-e));this.fSteer.multiplyScalar(s)}else this.fSteer.multiplyScalar(this.maxSpeed);this.fSteer.sub(this.velocity),this.fSteer.clampLength(-99999,this.maxForce),console.log(this.fSteer)}},{key:"setupPattern",value:function(){var t=function(t,e,i,n,a,r){return{pos:t,radx:e,radz:i,amp:n,dir:a,move:r}}(new d.Vector3(0,2,0),5,5,1,!0,d.Math.degToRad(.1));this.ellipsePattern=new k(t)}},{key:"updatePattern",value:function(){this.ellipsePattern.update();var t=this.ellipsePattern.getTargetPos();this.target.copy(t)}}]),t}(),S=i(41),M=i.n(S),x=new w.a,O=function(t){Object(c.a)(i,t);var e=Object(u.a)(i);function i(t){var n;return Object(o.a)(this,i),(n=e.call(this)).loadPigeon(t),n}return Object(h.a)(i,[{key:"loadPigeon",value:function(t){var e=this;x.load(M.a,(function(i){e.pigeon=i.scene,e.agent=new d.Group,e.agent.add(e.pigeon),e.agent.frustumCulled=!1,e.agent.castShadow=!0,e.agent.receiveShadow=!0,e.agentPosition=e.agent.position,e.agentRotation=e.agent.rotation,e.agentScale=e.agent.scale,e.agentAnimations=i.animations,e.animationMixer=new d.AnimationMixer(e.agent),e.animationMixer.clipAction(e.agentAnimations[0]).play(),t.add(e.agent)}),void 0,(function(t){console.error(t)}))}},{key:"update",value:function(t){this.animationMixer&&(this.animationMixer.update(t),this.updateAgent(),this.syncPosition())}},{key:"syncPosition",value:function(){this.agent.position.copy(this.position)}},{key:"syncRotation",value:function(){var t,e,i;i=this.velocity,t=Math.atan2(i.y,i.x),e=function(t){return Math.acos(t.z/t.length())}(this.velocity),y(0,0,1,t-Math.PI/2,this.rotationA),y(1,0,0,Math.PI/2-e,this.rotationB),this.rotationA.multiply(this.rotationB),this.agent.setRotationFromQuaternion(this.rotationA)}}]),i}(P),j=function(){function t(e){Object(o.a)(this,t);var i=new d.SphereGeometry(.2,15,15),n=new d.MeshLambertMaterial({color:new d.Color(1,0,0),wireframe:!1});this.mesh=new d.Mesh(i,n),e.add(this.mesh)}return Object(h.a)(t,[{key:"getVector",value:function(){return this.mesh.position}},{key:"setVector",value:function(t){this.mesh.position.copy(t)}},{key:"setVisibility",value:function(t){this.mesh.visible=t}}]),t}(),R=f()(d),V={container:{zIndex:0,top:"0%",overflowX:"hidden",overflowY:"auto"}},T={showGrid:!0,showTarget:!0},C=function(t){Object(c.a)(i,t);var e=Object(u.a)(i);function i(t){var n;return Object(o.a)(this,i),(n=e.call(this,t)).state={},n.ref=a.a.createRef(),n.scene=new d.Scene,n.setupCamera(),n.setupProps(),n.setupGui(),n.setupLighting(),n.setupRenderer(),n.setupOrbitControls(),n.pigeon=new O(n.scene),n.target=new j(n.scene),n.stats=new v.a,n.clock=new d.Clock,n}return Object(h.a)(i,[{key:"componentDidMount",value:function(){this.ref.current.appendChild(this.renderer.domElement),this.ref.current.appendChild(this.stats.dom),this.initThreeRender()}},{key:"update",value:function(){this.grid.visible=T.showGrid,this.target.setVisibility(T.showTarget);var t=this.clock.getDelta();this.pigeon.update(t);var e=this.pigeon.target;this.target.setVector(e)}},{key:"render",value:function(){return a.a.createElement("div",{style:V.container,ref:this.ref})}},{key:"initThreeRender",value:function(){this.stats.begin(),this.update(),this.controls.update(),this.renderer.render(this.scene,this.camera),this.stats.end(),requestAnimationFrame(this.initThreeRender.bind(this))}},{key:"setupRenderer",value:function(){this.renderer=new d.WebGLRenderer({antialias:!0}),this.renderer.setClearColor(1149471,1),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.outputEncoding=d.sRGBEncoding}},{key:"setupOrbitControls",value:function(){this.controls=new R(this.camera),this.controls.enablePan=!0,this.controls.enabled=!0,this.controls.enableKeys=!0}},{key:"setupCamera",value:function(){this.camera=new d.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.05,2e4),this.camera.position.set(4,4,4),this.camera.lookAt(new d.Vector3(0,0,0)),this.camera.frustumCulled=!1}},{key:"setupProps",value:function(){for(var t=0;t<100;t++){var e=new d.BoxGeometry(.5,.5,.5),i=new d.MeshBasicMaterial({color:6368300}),n=new d.Mesh(e,i),a=8*this.getRandomArbitrary(-1,1),r=8*this.getRandomArbitrary(-1,1);n.position.x=a,n.position.z=r,n.position.y=.25,this.scene.add(n)}var s=new d.PlaneGeometry(20,20),o=new d.MeshBasicMaterial({color:5429092,side:d.DoubleSide}),h=new d.Mesh(s,o);h.rotation.x=Math.PI/2,this.scene.add(h),this.grid=new d.GridHelper(30,10),this.scene.add(this.grid)}},{key:"setupLighting",value:function(){var t=new d.AmbientLight(14144467);t.intensity=1.5;var e=new d.DirectionalLight(16777215);e.intensity=3,e.position.set(0,50,50).normalize(),this.scene.add(t),this.scene.add(e)}},{key:"setupGui",value:function(){this.gui=new g.a,this.gui.add(T,"showGrid").name("Show Grid"),this.gui.add(T,"showTarget").name("Show Target")}},{key:"getRandomArbitrary",value:function(t,e){return Math.random()*(e-t)+t}}]),i}(a.a.Component),A=Object(l.a)(C),G=function(t){Object(c.a)(i,t);var e=Object(u.a)(i);function i(t){var n;return Object(o.a)(this,i),(n=e.call(this,t)).state={},n.totalRef=a.a.createRef(),n.worldRef=a.a.createRef(),n}return Object(h.a)(i,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(A,{ref:this.worldRef}))}},{key:"componentDidUpdate",value:function(){console.log(this.totalRef.current.scrollHeight)}}]),i}(a.a.Component),_=Object(l.a)(G),B=i(30);s.a.render(a.a.createElement(B.a,null,a.a.createElement(_,null)),document.getElementById("root"))}},[[70,1,2]]]);
//# sourceMappingURL=main.3cc67752.chunk.js.map